(this["webpackJsonptest-task-navek-soft"]=this["webpackJsonptest-task-navek-soft"]||[]).push([[0],{24:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),i=n(16),c=n.n(i),u=(n(24),n(2)),r=n(3),o=n(8),l=n(1);var p=function(e){var t=e.onSignOut;return Object(l.jsx)("header",{className:"header",children:Object(l.jsxs)(r.d,{children:[Object(l.jsx)(r.b,{path:"/main",children:Object(l.jsx)("div",{className:"header__container",children:Object(l.jsx)(o.b,{onClick:t,to:"/signin",className:"header__exit",children:"\u0412\u044b\u0439\u0442\u0438"})})}),Object(l.jsx)(r.b,{path:"/signup",children:Object(l.jsx)(o.b,{to:"/signin",className:"header__registration",children:"\u0412\u043e\u0439\u0442\u0438"})}),Object(l.jsx)(r.b,{path:"/signin",children:Object(l.jsx)(o.b,{to:"/signup",className:"header__login",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})})]})})};var j=function(e){return Object(l.jsxs)("article",{className:"element",children:[Object(l.jsx)("h2",{className:"element__title",children:e.review.title}),Object(l.jsx)("p",{className:"element__message",children:e.review.message})]})};var b=function(e){var t=e.reviews;return Object(l.jsx)("main",{className:"content",children:Object(l.jsx)("section",{className:"elements",children:t.map((function(e){return Object(l.jsx)(j,{review:e},e.id)}))})})};var g=function(){return Object(l.jsx)("footer",{className:"footer",children:Object(l.jsx)("p",{className:"footer__copyright",children:"\xa9 2021 Test Task Navek Soft"})})};var m=function(e){var t=e.onRegister,n=Object(a.useState)(""),s=Object(u.a)(n,2),i=s[0],c=s[1],r=Object(a.useState)(""),o=Object(u.a)(r,2),p=o[0],j=o[1],b=Object(a.useState)(""),g=Object(u.a)(b,2),m=g[0],O=g[1],d=Object(a.useState)(""),h=Object(u.a)(d,2),f=h[0],_=h[1],v=Object(a.useState)(""),x=Object(u.a)(v,2),N=x[0],S=x[1],k=Object(a.useState)(!1),w=Object(u.a)(k,2),y=w[0],C=w[1],E=Object(a.useState)(!1),F=Object(u.a)(E,2),T=F[0],B=F[1],L=Object(a.useState)(!1),A=Object(u.a)(L,2),I=A[0],z=A[1],q=Object(a.useState)(!1),P=Object(u.a)(q,2),J=P[0],Z=P[1],D=Object(a.useState)(""),$=Object(u.a)(D,2),R=$[0],V=$[1],M=Object(a.useState)("Email \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),G=Object(u.a)(M,2),H=G[0],K=G[1],Q=Object(a.useState)("\u0418\u043c\u044f \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),U=Object(u.a)(Q,2),W=U[0],X=U[1],Y=Object(a.useState)("\u041f\u0430\u0440\u043e\u043b\u044c \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),ee=Object(u.a)(Y,2),te=ee[0],ne=ee[1],ae=Object(a.useState)("\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),se=Object(u.a)(ae,2),ie=se[0],ce=se[1],ue=Object(a.useState)(!1),re=Object(u.a)(ue,2),oe=re[0],le=re[1];Object(a.useEffect)((function(){le(!(H||W||te||ie))}),[H,W,te,ie]);var pe=function(e){switch(e.target.name){case"email":C(!0);break;case"name":B(!0);break;case"password":z(!0);break;case"password_confirmation":Z(!0)}};return Object(l.jsx)("section",{className:"sign-up",children:Object(l.jsxs)("div",{className:"sign-up__content",children:[Object(l.jsx)("h3",{className:"sign-up__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(i,p,m,f,N)},className:"sign-up__form",noValidate:!0,children:[Object(l.jsxs)("p",{className:"sign-up__avatar-upload-text",children:["\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 jpeg/bmp/png \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443 \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c \u043d\u0435 \u0431\u043e\u043b\u0435\u0435 10\u041c\u0411",Object(l.jsx)("span",{className:"sign-up__optional-input",children:" *\u043d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"})]}),Object(l.jsx)("input",{value:i,type:"file",onChange:function(e){return function(e){c(e.target.value);var t=e.target.files[0];t?t.name.match(/\.(jpeg|bmp|png)$/)?t.size>1e7?(console.log(t.size),V("\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443 \u043c\u0435\u043d\u044c\u0448\u0435 10\u041c\u0411")):V(""):V("\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u043e\u0440\u043c\u0430\u0442 jpeg/bmp/png"):V("")}(e)},id:"sign-up-avatar-input",name:"avatar",placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043b",className:"sign-up__input sign-up__input_type_avatar"}),Object(l.jsx)("label",{className:"sign-up__input-label",htmlFor:"sign-up-avatar-input",children:R}),Object(l.jsx)("input",{value:p,id:"sign-up-email-input",className:"sign-up__input sign-up__input_type_email",type:"email",name:"email",placeholder:"Email",required:!0,onBlur:function(e){return pe(e)},onChange:function(e){return function(e){j(e.target.value),/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e.target.value).toLowerCase())?K(""):(K("\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 email, \u043f\u0440\u0438\u043c\u0435\u0440: text@mail.ru"),e.target.value||K("Email \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"))}(e)}}),y&&H&&Object(l.jsx)("label",{className:"sign-up__input-label",htmlFor:"sign-up-email-input",children:H}),Object(l.jsx)("input",{value:m,id:"sign-up-name-input",className:"sign-up__input sign-up__input_type_name",type:"text",name:"name",onBlur:function(e){return pe(e)},onChange:function(e){return function(e){O(e.target.value),e.target.value.length>255?(e.target.value||X("\u0418\u043c\u044f \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),X("\u0418\u043c\u044f \u0434\u043e\u043b\u0436\u0435\u043d\u043e \u0431\u044b\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435 255-\u0442\u0438 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")):X("")}(e)},placeholder:"\u0418\u043c\u044f",required:!0}),T&&W&&Object(l.jsx)("label",{className:"sign-up__input-label",htmlFor:"sign-up-name-input",children:W}),Object(l.jsx)("input",{value:f,id:"sign-up-password-input",className:"sign-up__input sign-up__input_type_password",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",required:!0,onBlur:function(e){return pe(e)},onChange:function(e){return function(e){_(e.target.value),e.target.value.length<8?(ne("\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 8-\u043c\u0438 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),e.target.value||ne("\u041f\u0430\u0440\u043e\u043b\u044c \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c")):e.target.value.length>255?ne("\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435 255-\u0442\u0438 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"):ne("")}(e)}}),I&&te&&Object(l.jsx)("label",{className:"sign-up__input-label",htmlFor:"sign-up-password-input",children:te}),Object(l.jsx)("input",{value:N,id:"sign-up-password-confirmation-input",className:"sign-up__input sign-up__input_type_password-\u0441onfirmation",type:"password",name:"password_confirmation",onBlur:function(e){return pe(e)},onChange:function(e){return function(e){S(e.target.value),e.target.value.length<8?(ce("\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 8-\u043c\u0438 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),e.target.value||ce("\u041f\u0430\u0440\u043e\u043b\u044c \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c")):e.target.value.length>255?ce("\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435 255-\u0442\u0438 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"):e.target.value!==f?ce("\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442"):ce("")}(e)},placeholder:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",required:!0}),J&&ie&&Object(l.jsx)("label",{className:"sign-up__input-label",htmlFor:"sign-up-password-confirmation-input",children:ie}),Object(l.jsx)("button",{disabled:!oe,type:"submit",className:"sign-up__save",value:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})]})})};var O=function(e){var t=e.onLogin,n=Object(a.useState)(""),s=Object(u.a)(n,2),i=s[0],c=s[1],r=Object(a.useState)(""),o=Object(u.a)(r,2),p=o[0],j=o[1],b=Object(a.useState)(!1),g=Object(u.a)(b,2),m=g[0],O=g[1],d=Object(a.useState)(!1),h=Object(u.a)(d,2),f=h[0],_=h[1],v=Object(a.useState)("Email \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),x=Object(u.a)(v,2),N=x[0],S=x[1],k=Object(a.useState)("\u041f\u0430\u0440\u043e\u043b\u044c \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),w=Object(u.a)(k,2),y=w[0],C=w[1],E=Object(a.useState)(!1),F=Object(u.a)(E,2),T=F[0],B=F[1];Object(a.useEffect)((function(){B(!N&&!y)}),[N,y]);var L=function(e){switch(e.target.name){case"email":O(!0);break;case"password":_(!0)}};return Object(l.jsx)("section",{className:"sing-in",children:Object(l.jsxs)("div",{className:"sign-in__content",children:[Object(l.jsx)("h3",{className:"sing-in__title",children:"\u0412\u0445\u043e\u0434"}),Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(i,p)},className:"sing-in__form",noValidate:!0,children:[Object(l.jsx)("input",{value:i,id:"sing-in-email-input",className:"sing-in__input sing-in__input_type_email",type:"email",name:"email",placeholder:"Email",required:!0,onBlur:function(e){return L(e)},onChange:function(e){return function(e){c(e.target.value),/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e.target.value).toLowerCase())?S(""):(S("\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 email, \u043f\u0440\u0438\u043c\u0435\u0440: text@mail.ru"),e.target.value||S("Email \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"))}(e)}}),m&&N&&Object(l.jsx)("label",{className:"sing-in__input-label",htmlFor:"sing-in-email-input",children:N}),Object(l.jsx)("input",{value:p,id:"sing-in-password-input",className:"sing-in__input sing-in__input_type_password",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",required:!0,onBlur:function(e){return L(e)},onChange:function(e){return function(e){j(e.target.value),e.target.value.length<8?(C("\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 8-\u043c\u0438 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),e.target.value||C("\u041f\u0430\u0440\u043e\u043b\u044c \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c")):e.target.value.length>255?C("\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435 255-\u0442\u0438 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"):C("")}(e)}}),f&&y&&Object(l.jsx)("label",{className:"sing-in__input-label",htmlFor:"sing-in-password-input",children:y}),Object(l.jsx)("button",{disabled:!T,type:"submit",className:"sing-in__save",value:"\u0412\u0445\u043e\u0434",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})},d=n(18),h=n(19),f=function(e){var t=e.component,n=Object(h.a)(e,["component"]);return Object(l.jsx)(r.b,{children:function(){return!0===n.loggedIn?Object(l.jsx)(t,Object(d.a)({},n)):Object(l.jsx)(r.a,{to:"/signin"})}})},_=function(e){return fetch("".concat("https://guest-book.naveksoft.com","/api/v1/posts"),{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}(e)}))},v="https://guest-book.naveksoft.com",x=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))};var N=function(e){var t=e.title,n=e.isOpen,s=e.onClose,i=e.onOvarlayClose;return Object(a.useEffect)((function(){if(n){var e=function(e){27===e.keyCode&&s()};return document.addEventListener("keyup",e),function(){document.removeEventListener("keyup",e)}}})),Object(l.jsx)("div",{className:"popup ".concat(n&&"popup_opened"),onClick:i,children:Object(l.jsxs)("div",{className:"popup__content",children:[Object(l.jsx)("button",{className:"popup__close",type:"button",onClick:s}),Object(l.jsx)("h3",{className:"popup__title",children:t})]})})};var S=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],s=t[1],i=Object(r.g)(),c=Object(a.useState)([]),o=Object(u.a)(c,2),j=o[0],d=o[1],h=Object(a.useState)({title:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"}),S=Object(u.a)(h,2),k=S[0],w=S[1],y=Object(a.useState)(!1),C=Object(u.a)(y,2),E=C[0],F=C[1];function T(){F(!0)}function B(){F(!1)}function L(){var e=localStorage.getItem("token");_(e).then((function(e){d(e.data.slice(0,15))})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438".concat(e))}))}var A=Object(a.useCallback)((function(){localStorage.getItem("token")?(L(),s(!0),i.push("/main")):i.push("/signin")}),[i]);return Object(a.useEffect)((function(){A()}),[A]),Object(l.jsx)("div",{className:"page",children:Object(l.jsxs)("div",{className:"page__container",children:[Object(l.jsx)(p,{onSignOut:function(){localStorage.removeItem("token"),s(!1),i.push("/signin")}}),Object(l.jsxs)(r.d,{children:[Object(l.jsx)(f,{path:"/main",loggedIn:n,component:b,reviews:j}),Object(l.jsx)(r.b,{path:"/signup",children:Object(l.jsx)(m,{onRegister:function(e,t,n,a,s){(function(e,t,n,a,s){return fetch("".concat(v,"/api/v1/auth/register"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({avatar:e,email:t,name:n,password:a,password_confirmation:s})}).then((function(e){return x(e)}))})(e,t,n,a,s).then((function(e){T(),w({title:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"}),i.push("/signin")})).catch((function(e){T(),"\u041e\u0448\u0438\u0431\u043a\u0430 422"==="".concat(e)?w({title:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0442\u0430\u043a\u0438\u043c email \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442!"}):w({title:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a!"}),i.push("/signup")}))}})}),Object(l.jsx)(r.b,{path:"/signin",children:Object(l.jsx)(O,{onLogin:function(e,t){(function(e,t){return fetch("".concat(v,"/api/v1/auth/login"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return x(e)}))})(e,t).then((function(e){e.token.access_token&&(s(!0),localStorage.setItem("token",e.token.access_token),L(),i.push("/main"))})).catch((function(e){T(),"\u041e\u0448\u0438\u0431\u043a\u0430 422"==="".concat(e)?w({title:"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0432\u0432\u0435\u0434\u0435\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435!"}):w({title:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a!"}),i.push("/signin")}))},handleTokenCheck:A})}),Object(l.jsx)(r.b,{children:n?Object(l.jsx)(r.a,{to:"/main"}):Object(l.jsx)(r.a,{to:"/signin"})})]}),n&&Object(l.jsx)(g,{}),Object(l.jsx)(N,{title:k.title,isOpen:E,onClose:B,onOvarlayClose:function(e){e.target.classList.contains("popup")&&B()}})]})})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,32)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),s(e),i(e),c(e)}))};c.a.render(Object(l.jsx)(s.a.StrictMode,{children:Object(l.jsx)(o.a,{children:Object(l.jsx)(S,{})})}),document.getElementById("root")),k()}},[[31,1,2]]]);
//# sourceMappingURL=main.c3f72b2d.chunk.js.map